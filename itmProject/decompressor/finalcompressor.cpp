#include <cmath>
#include <fstream>
#include <cstring>
#include <iostream>
#include <vector>
typedef double v;typedef int w;class s{public:s(FILE*a):a(a),b(0),c(0){};void t(char*d,w e){w f=0;while(f<e){if(b==0){c=fgetc(a);}if(f%8==0){*d=0;}*d|=(c&(1<<b)?1:0)<<f%8;b++;b%=8;f++;if(f%8==0){d++;}}}FILE*a;w b;w c;};class u{public:u(){for(w i=0;i<9;i++){m[i]=0;}}v h(v a,v b){v c=0;v x=(a+4)/8;v y=(b+4)/5.35;c+=(1-x)*(1-x)*(1-y)*(1-y)*m[0];c+=2*(x)*(1-x)*(1-y)*(1-y)*m[1];c+=(x)*(x)*(1-y)*(1-y)*m[2];c+=2*(1-x)*(1-x)*(y)*(1-y)*m[3];c+=2*2*(x)*(1-x)*(y)*(1-y)*m[4];c+=2*(x)*(x)*(y)*(1-y)*m[5];c+=(1-x)*(1-x)*(y)*(y)*m[6];c+=2*(x)*(1-x)*(y)*(y)*m[7];c+=(x)*(x)*(y)*(y)*m[8];return c;};w o(v a,v b){return h(a,b)*1000;}v m[9];};w r(v x,v y,v z){v t=(x+4.0)/8.0;v cutoff=t*t*14.0+2.0*t*(1.0-t)*(-16.0)+(1.0-t)*(1.0-t)*(-7.6);if(z>cutoff){return 0;}return 1;}std::vector<std::vector<v>>p(std::string c){std::ifstream b{c};std::vector<std::vector<v>>a;for(w i=0;i<20000;i++){v x,y;b>>x;b>>y;a.emplace_back();a.back().push_back(x);a.back().push_back(y);}return a;}w main(w m,char**l){u a;u b;FILE*c=fopen(l[3],"rb");s d{c};auto e=p(l[2]);for(w i=0;i<9;i++){d.t((char*)&a.m[i],sizeof(v)*8);d.t((char*)&b.m[i],sizeof(v)*8);}for(w i=0;i<20000;i++){w g=0;w h=0;w n=0;d.t((char*)&g,1);d.t((char*)&h,1);d.t((char*)&n,12);if(h){n*=-1;}w f;if(g==0){f=a.o(e[i][0],e[i][1]);}else{f=b.o(e[i][0],e[i][1]);}w j=f+n;v k=j/1000.0;printf("%1.3f\n",k);}fclose(c);}
